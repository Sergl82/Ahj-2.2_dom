(()=>{"use strict";const t=[{id:26,title:"Побег из Шоушенка",imdb:9.3,year:1994},{id:25,title:"Крёстный отец",imdb:9.2,year:1972},{id:27,title:"Крёстный отец 2",imdb:9,year:1974},{id:1047,title:"Тёмный рыцарь",imdb:9,year:2008},{id:223,title:"Криминальное чтиво",imdb:8.9,year:1994}];const e=document.querySelector("tbody"),i=new class{constructor(e){this.table=e,this.data=t,this.sort=[]}init(){this.redrawTable(),this.attrs=[...document.querySelector(".movie").getAttributeNames()],this.displayValue(this.attrs,1)}redrawTable(){this.data.forEach((t=>{const e=`\n<tr class="movie" data-id="${t.id}" data-title="${t.title}" data-year="${t.year}" data-imdb="${t.imdb.toFixed(2)}">\n\t\t\t\t<td>${t.id}</td>\n\t\t\t\t<td>${t.title}</td>\n\t\t\t\t<td>(${t.year})</td>\n\t\t\t\t<td>imdb: ${t.imdb.toFixed(2)}</td>\n\t\t\t</tr>`;this.table.insertAdjacentHTML("beforeend",e)}))}sortValues(t){return this.movie=document.querySelectorAll(".movie"),t=t.substr(5),this.sort="title"===t?[...this.movie].sort(((t,e)=>e.dataset.title>t.dataset.title?1:e.dataset.title<t.dataset.title?-1:void 0)):[...this.movie].sort(((e,i)=>Number(i.dataset[t])-Number(e.dataset[t]))),this.sort}refresh(){this.redrawList(this.movie,this.sort),this.sort=this.sort.reverse(),setTimeout((()=>{this.redrawList(this.movie,this.sort)}),2e3)}redrawList(t,e){const i=[...document.querySelectorAll("th")].find((t=>t.firstElementChild.classList.contains("triangle-up")));i&&(i.firstElementChild.style.transform="rotate(180deg)"),t.forEach((t=>{document.querySelector("tbody").removeChild(t)})),e.forEach((t=>{document.querySelector("tbody").append(t)}))}triangle(t){const e=document.querySelectorAll("th");[...e].forEach((t=>{t.firstElementChild.classList.remove("triangle-up"),t.firstElementChild.style.transform=""}));[...e].find((e=>e.textContent===t)).firstElementChild.classList.add("triangle-up")}displayValue(t,e){if(e<t.length){const i=setTimeout((()=>{e<t.length&&(this.sortValues(t[e]),this.refresh(),this.triangle(t[e].substr(5)),this.displayValue(t,[++e]),e===t.length&&(clearTimeout(i),e=1,this.displayValue(t,e)))}),4e3)}}}(e);i.init()})();